---
title: "Untitled"
author: "Tai Yue"
date: "2024-12-04"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```





```{r}
library(readxl)
library(dplyr)

file_path <- "fluidmilk.xlsx"
fluidmilk_data <- read_excel(file_path, sheet = "fluidmilk")


colnames(fluidmilk_data) <- c("Year", "Whole_Milk", "Reduced_Fat_2_%", 
                              "Low_Fat_1_%", "Skim", "Flavored_Whole", 
                              "Flavored_Other", "Buttermilk", "Eggnog", "Total_Sales")


fluidmilk_data <- fluidmilk_data %>%
  mutate(Year = as.numeric(Year)) %>%
  filter(!is.na(Year))


fluidmilk_data <- fluidmilk_data %>%
  mutate(across(Whole_Milk:Total_Sales, as.numeric))

print(fluidmilk_data)

key_stats <- fluidmilk_data %>%
  summarise(
    across(everything(), list(mean = mean, sd = sd, min = min, max = max), na.rm = TRUE)
  )


print(key_stats)

```

#Trends in Different Milk Types Over Time:

```{r}
library(plotly)
library(ggplot2)
library(tidyr)


colnames(fluidmilk_data) <- c("Year", "Whole_Milk", "Reduced_Fat_2_Percent", 
                              "Low_Fat_1_Percent", "Skim", "Flavored_Whole", 
                              "Flavored_Other", "Buttermilk", "Eggnog", "Total_Sales")


fluidmilk_data <- fluidmilk_data %>%
  mutate(Year = as.numeric(Year)) %>%  
  filter(!is.na(Year)) %>%             
  mutate(across(Whole_Milk:Total_Sales, as.numeric))  


fluidmilk_long <- fluidmilk_data %>%
  select(Year, Whole_Milk, Reduced_Fat_2_Percent, Low_Fat_1_Percent, Skim) %>%
  pivot_longer(cols = -Year, names_to = "Milk_Type", values_to = "Sales")

print(head(fluidmilk_long))
summary(fluidmilk_long)


if (any(is.na(fluidmilk_long$Sales))) {
  print("Warning: There are missing values in the Sales column.")
}


milk_colors <- c(
  "Whole_Milk" = "red", 
  "Reduced_Fat_2_Percent" = "orange", 
  "Low_Fat_1_Percent" = "magenta", 
  "Skim" = "pink"
)


ggplot_basic <- ggplot(fluidmilk_long, aes(x = Year, y = Sales, color = Milk_Type)) +
  geom_line(size = 1) +
  scale_color_manual(values = milk_colors) + 
  labs(title = "Trends in Different Milk Types Over Time", 
       x = "Year", 
       y = "Sales (Million Pounds)", 
       color = "Milk Type") +
  theme_minimal()

print(ggplot_basic)
ggplotly(ggplot_basic)


ggplot_interactive <- ggplot(fluidmilk_long, aes(
  x = Year, 
  y = Sales, 
  color = Milk_Type, 
  text = paste0("Year: ", Year, 
                "<br>Milk Type: ", Milk_Type, 
                "<br>Sales: ", round(Sales, 2))
)) +
  geom_line(size = 1) +
  scale_color_manual(values = milk_colors) + 
  labs(title = "Trends in Different Milk Types Over Time", 
       x = "Year", 
       y = "Sales (Million Pounds)", 
       color = "Milk Type") +
  theme_minimal()


interactive_plot <- ggplotly(ggplot_interactive, tooltip = "text")

interactive_plot



```

Trends in Different Milk Types Over Time:

a.The sales of whole milk have experienced a dramatic decline since 1975. Initially the dominant milk type, it steadily decreased as consumers shifted toward lower-fat alternatives, reflecting changing dietary preferences and health trends.

b. Reduced-Fat (2%) Milk: gained popularity starting in the late 1970s and peaked around the 1990s. However, its sales began to decline after 2010, mirroring the overall decline in fluid milk consumption.

c. Skim milk experienced gradual growth from the 1980s to the early 2000s, reflecting increasing health- consciousness. However, its sales have significantly declined since the mid-2000s, suggesting a loss of favor among consumers, possibly due to taste or the rise of alternatives.

d.Sales of 1% milk have remained relatively stable over the years, though they have seen a slight decline post-2010.

While there was a clear shift from whole milk to reduced-fat and skim milk during the late 20th century, all categories have experienced declining sales since 2010. This underscores a broader trend of declining fluid milk consumption, possibly driven by the rise of plant-based alternatives, changing dietary habits, and demographic shifts.

