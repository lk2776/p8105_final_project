---
title: "Nutrition"
output: html_document
date: "2024-11-28"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(readxl)
```


```{R}
df <- readxl::read_xlsx('nutri.xlsx')|>
  head(11)
nutri <- df |>
  as.data.frame() |>
  mutate(Whole = as.double(Whole))
nutri_d <- nutri |>
  mutate(mean_diff = rowMeans(across(c(Whole, `2 Percent`, `1 Percent`))) -Skim) |>
  select(c(1,6))
print(nutri_d)

```

```{R}
extra = c (0,0,0,0)
selected_rows <- nutri[c(1, 3, 5, 11), ]
nutri_bp = cbind(selected_rows, extra)
rows_to_plot <- c(1, 2, 3, 4)
legend_labels <- names(nutri_bp)[2:(ncol(nutri_bp) - 1)]

# Loop
for (i in rows_to_plot) {
  values <- as.numeric(nutri_bp[i, 2:ncol(nutri_bp)])
  plot_title <- nutri_bp[i, 1]
  bc = c("red","magenta","lightblue","cyan","transparent")
  bar_pos <- barplot(values, main = plot_title, col = bc, border = NA) 
  for (j in seq_along(values)) { if (values[j] != 0) { 
    rect(bar_pos[j] - 0.5, 0, bar_pos[j] + 0.5, values[j], border = "black") } 
    } 
  legend("topright", legend = legend_labels, fill = bc[-length(bc)], title = "Components", cex = 0.8)
}

```

```{R}
# Making a layout
layout(matrix(c(1, 1, 2, 3, 4, 5), nrow=3, ncol=2, byrow=TRUE), heights=c(0.2, 1, 1))
par(mar=c(0, 0, 2, 0)) # Adjust margins for the title
plot.new()
title(main="Cholesterol Intake /cup for a 2000 calorie diet", cex.main=2, font.main=2)
percentages <- c(12, 6, 5, 2)
titles <- c("Whole Milk", "2% Milk", "1% Milk", "Skim Milk")
colors <- c("red", "white")

par(mar=c(4, 4, 2, 2)) # Adjusting margins

#Pie charts
for (i in 1:4) { pie(c(percentages[i], 100 - percentages[i]), labels = c("", ""), col = colors, main = titles[i], cex = 1.5)}
```
